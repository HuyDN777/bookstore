<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Bookstore Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
        <div class="container">
            <a class="navbar-brand" href="{% url 'book_home' %}">üìö Nh√† s√°ch</a>
            <div class="navbar-nav ms-auto">
                {% if user.is_authenticated %}
                    <a class="nav-link" href="{% url 'customer_profile' %}">Xin ch√†o, {{ user.username }}</a>
                    <a class="nav-link" href="{% url 'customer_logout' %}">ƒêƒÉng xu·∫•t</a>
                {% else %}
                    <a class="nav-link" href="{% url 'customer_login' %}">ƒêƒÉng nh·∫≠p</a>
                    <a class="nav-link" href="{% url 'customer_register' %}">ƒêƒÉng k√Ω</a>
                {% endif %}
                {% if user.is_authenticated %}
                    <a class="nav-link" href="{% url 'view_cart' %}">üõí Gi·ªè h√†ng</a>
                {% endif %}
            </div>
        </div>
    </nav>
    
    <div class="container mt-3">
        <h1 class="text-center mb-4">Ch√†o m·ª´ng ƒë·∫øn v·ªõi Nh√† s√°ch</h1>
        
        <!-- Form t√¨m ki·∫øm -->
        <div class="card mb-4">
            <div class="card-body">
                <form method="GET" action="{% url 'book_home' %}">
                    <div class="row">
                        <div class="col-md-4">
                            <input type="text" class="form-control" name="search" placeholder="T√¨m ki·∫øm s√°ch, t√°c gi·∫£..." value="{{ search_query }}">
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" name="category">
                                <option value="">T·∫•t c·∫£ danh m·ª•c</option>
                                {% for category in categories %}
                                    <option value="{{ category.id }}" {% if selected_category == category.id %}selected{% endif %}>
                                        {{ category.name }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-3">
                            <button type="submit" class="btn btn-primary w-100">üîç T√¨m ki·∫øm</button>
                        </div>
                        <div class="col-md-2">
                            <a href="{% url 'book_home' %}" class="btn btn-secondary w-100">X√≥a b·ªô l·ªçc</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="row g-4">
            {% for book in books %}
            <div class="col-sm-6 col-md-4 col-lg-3">
                <div class="card h-100 shadow-sm border-0 rounded-4 overflow-hidden"
                     style="transition: transform .15s ease, box-shadow .15s ease;"
                     onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.15)'"
                     onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'">
                    {% if book.image_url %}
                    <img src="{{ book.image_url }}" class="card-img-top" alt="{{ book.title }}"
                         style="height: 280px; width: 100%; object-fit: cover; background-color: #f8f9fa;">
                    {% else %}
                    <div class="bg-light text-muted d-flex justify-content-center align-items-center"
                         style="height: 280px; font-size: 0.9rem;">
                        üìö Kh√¥ng c√≥ ·∫£nh
                    </div>
                    {% endif %}

                    <div class="card-body d-flex flex-column">
                        <span class="badge bg-secondary mb-2">
                            {% if book.category %}{{ book.category.name }}{% else %}Kh√°c{% endif %}
                        </span>
                        <h5 class="card-title mb-1 text-truncate" title="{{ book.title }}">
                            {{ book.title }}
                        </h5>
                        <p class="text-muted mb-2 small text-truncate" title="{{ book.author }}">
                            T√°c gi·∫£: {{ book.author }}
                        </p>
                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <span class="fw-bold text-danger fs-6">
                                {{ book.price|floatformat:0 }} VNƒê
                            </span>
                            <a href="{% url 'book_detail' book.id %}" class="btn btn-sm btn-primary rounded-pill px-3">
                                Xem chi ti·∫øt
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="alert alert-warning w-100 text-center">
                Ch∆∞a c√≥ cu·ªën s√°ch n√†o trong kho! H√£y nh·ªù nh√¢n vi√™n nh·∫≠p th√™m.
            </div>
            {% endfor %}
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>